	include "../../fpureg.i"

DUMP    MACRO
        fmove   FPSR,16(a2)
        fmove.l #0,FPSR
        fmove.x FP0,(a2)
        fmove   FPSR,20(a2)
        add.l   #24,a2
        ENDM

trap0:

    movem.l d0/d1/a2,-(a7) 

    lea     values,a2 

    ; Setup registers
    fmove.l #0,FPCR
    fmove.l #0,FPSR

    ; 1+2+3: Zero (sign bit = 0)
    fmove.x #$000000000000000000000000,FP0
    DUMP 

    ; 4+5+6: Zero (sign bit = 1)
    fmove.x #$800000000000000000000000,FP0
    DUMP 

    ; 7+8+9: Infinity (sign bit = 0)
    fmove.x #$7FFF00000000000000000000,FP0
    DUMP 

    ; 10+11+12: Infinity (sign bit = 1)
    fmove.x #$FFFF00000000000000000000,FP0
    DUMP 

    ; 13+14+15: Signaling NaN (sign bit = 0)
    fmove.x #$7FFF00000000000000000001,FP0
    DUMP 

    ; 16+17+18: Nonsignaling NaN (sign bit = 0)
    fmove.x #$7FFF00004000000000000000,FP0
    DUMP 

    ; 19+20+21: Signaling NaN (sign bit = 1)
    fmove.x #$FFFF00000000000000000001,FP0
    DUMP 

    ; 22+23+24: Nonsignaling NaN (sign bit = 1)
    fmove.x #$FFFF00004000000000000001,FP0
    DUMP 

    movem.l (a7)+,d0/d1/a2
    rte

info: 
    dc.b    'SPECIAL2-X', 0
    even 

expected:
    dc.b    $00,$00,$00,$00,  $00,$00,$00,$00  ; 1
    dc.b    $00,$00,$00,$00,  $00,$00,$00,$00  ; 2
    dc.b    $04,$00,$00,$00,  $00,$00,$00,$00  ; 3
    dc.b    $80,$00,$00,$00,  $00,$00,$00,$00  ; 4
    dc.b    $00,$00,$00,$00,  $00,$00,$00,$00  ; 5
    dc.b    $0C,$00,$00,$00,  $00,$00,$00,$00  ; 6
    dc.b    $7F,$FF,$00,$00,  $00,$00,$00,$00  ; 7
    dc.b    $00,$00,$00,$00,  $00,$00,$00,$00  ; 8
    dc.b    $02,$00,$00,$00,  $00,$00,$00,$00  ; 9
    dc.b    $FF,$FF,$00,$00,  $00,$00,$00,$00  ; 10
    dc.b    $00,$00,$00,$00,  $00,$00,$00,$00  ; 11
    dc.b    $0A,$00,$00,$00,  $00,$00,$00,$00  ; 12
    dc.b    $7F,$FF,$00,$00,  $40,$00,$00,$00  ; 13
    dc.b    $00,$00,$00,$01,  $00,$00,$00,$00  ; 14
    dc.b    $01,$00,$40,$80,  $00,$00,$00,$00  ; 15
    dc.b    $7F,$FF,$00,$00,  $40,$00,$00,$00  ; 16
    dc.b    $00,$00,$00,$00,  $00,$00,$00,$00  ; 17
    dc.b    $01,$00,$00,$00,  $00,$00,$00,$00  ; 18
    dc.b    $FF,$FF,$00,$00,  $40,$00,$00,$00  ; 19
    dc.b    $00,$00,$00,$01,  $00,$00,$00,$00  ; 20
    dc.b    $09,$00,$40,$80,  $00,$00,$00,$00  ; 21
    dc.b    $FF,$FF,$00,$00,  $40,$00,$00,$00  ; 22
    dc.b    $00,$00,$00,$01,  $00,$00,$00,$00  ; 23
    dc.b    $09,$00,$00,$00,  $00,$00,$00,$00  ; 24
